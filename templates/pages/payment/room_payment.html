<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pay for Room Booking</title>
    <script src="https://sandbox.irembopay.com/widget.js"></script>
</head>
<body>
    <h1>Complete Payment</h1>

    <div>
        <p><strong>Hotel:</strong> {{ payment.booking.room.hotel.name }}</p>
        <p><strong>Room:</strong> {{ payment.booking.room.name }}</p>
        <p><strong>Invoice Number:</strong> {{ payment.invoice_number }}</p>
        <p><strong>Total:</strong> {{ payment.booking.total_price }} USD</p>
    </div>

    <button id="payButton">Pay Now</button>

    <script>
        const publicKey = "{{ public_key }}";
        const invoiceNumber = "{{ payment.invoice_number }}";

        document.getElementById("payButton").addEventListener("click", function () {
            if (!publicKey || !invoiceNumber) {
                alert("Missing public key or invoice number");
                return;
            }

            console.log("üöÄ Initiating IremboPay...");
            console.log("üßæ Invoice Number:", invoiceNumber);
            console.log("üîê Public Key:", publicKey);

            IremboPay.init({
                invoiceNumber: invoiceNumber,
                publicKey: publicKey,
                onComplete: function (response) {
                    console.log("‚úÖ Payment Complete:", response);
                    // Optional: redirect to success page
                },
                onError: function (error) {
                    console.error("‚ùå Payment Failed:", error);
                }
            });
        });
    </script>
</body>
</html>
